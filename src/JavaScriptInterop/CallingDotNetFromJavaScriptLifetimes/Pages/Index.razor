@page "/"
@inject IJSRuntime JSRuntime
@implements IDisposable

<h1>Text received</h1>
<ul>
	@foreach (string text in TextHistory)
	{
		<li>@text</li>
	}
</ul>

@code
{
	List<string> TextHistory = new List<string>();
	DotNetObjectReference<Index> ObjectReference;

	protected override void OnInitialized()
	{
		base.OnInitialized();
		ObjectReference = DotNetObjectReference.Create(this);
		JSRuntime.InvokeVoidAsync("BlazorUniversity.startRandomGenerator", ObjectReference);
	}

	[JSInvokable("AddText")]
	public void AddTextToTextHistory(string text)
	{
		TextHistory.Add(text.ToString());
		while (TextHistory.Count > 10)
			TextHistory.RemoveAt(0);
		StateHasChanged();
		System.Diagnostics.Debug.WriteLine("DotNet: Received " + text);
	}

	void IDisposable.Dispose()
	{
		ObjectReference.Dispose();
	}
}
